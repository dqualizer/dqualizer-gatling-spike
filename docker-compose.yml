version: '3.9'

services:
  influxdb:
    image: influxdb:latest
    container_name: "gatling-influx"
    ports:
      - "8086:8086"
    env_file:
      - ./env/.env

  grafana:
    image: grafana/grafana:9.1.8
    container_name: "gatling-grafana"
    volumes:
      - ./docker-config/grafana/provisioning:/usr/share/grafana/custom/
      - ./docker-config/grafana/my-dashboards:/usr/share/grafana/public/dashboards
    ports:
      - "3030:3000"
    env_file:
      - ./env/.env
    environment:
      - GF_PANELS_DISABLE_SANITIZE_HTML=TRUE
      - GF_SECURITY_ADMIN_PASSWORD=admin
      - GF_PATHS_PROVISIONING=/usr/share/grafana/custom/
    depends_on:
      - influxdb

  graphite:
    image: graphiteapp/graphite-statsd
    container_name: "gatling-graphite"
    ports:
      - "2003:2003"
      - "2004:2004"
    depends_on:
      - telegraf

  telegraf:
    image: telegraf
    container_name: "gatling-telegraf"
    volumes:
      - ./docker-config/influx/telegraf.conf:/etc/telegraf/telegraf.conf:ro
    ports:
      - "8125:8125"
    env_file:
      - ./env/.env
    depends_on:
      - influxdb

